<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<ul id="ul">
			
		</ul>
	</body>
	<script src="jsonp.js"></script>
	<script>
		let ul = document.getElementById('ul')
		let url = 'http://www.wookmark.com/api/json/popular';
		
		let iw = document.documentElement.clientWidth;
		let picW = 236;
		let margin = 10;
		let sjw = picW + margin
		let len = Math.floor((iw-margin)/sjw)

		ul.style.width = len*sjw + 'px'

		let arrL = [];
		let arrT = [];
		let num=0;

		for(let i=0;i<len;i++){
			arrL.push(sjw * i)
			arrT.push(0)
		}
		
		fetchJsonp(url,{jsonpCallback: 'callback'})
		.then(res=>res.json()).then(res=>{
			console.log(res)
			let html = '';
			res.forEach(e=>{
				let img = new Image;
				img.src = e.preview

				img.onload = function(){
					num++;
					
				}
			});
			ul.innerHTML = html
		})
	</script>
</html>
